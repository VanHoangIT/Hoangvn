{% extends "base.html" %}

{% block title %}Dự án tiêu biểu - {{ config.SITE_NAME }}{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<section class="breadcrumb-section py-4 bg-light">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="{{ url_for('main.index') }}">Trang chủ</a></li>
                <li class="breadcrumb-item active">Dự án tiêu biểu</li>
            </ol>
        </nav>
    </div>
</section>

<!-- Page Header -->
<section class="page-header py-5">
    <div class="container text-center">
        <h1 class="display-4 fw-bold mb-3">Dự án tiêu biểu</h1>
        <p class="lead text-muted">
            Những dự án tiêu biểu mà chúng tôi đã thực hiện
        </p>
    </div>
</section>

<!-- Filter -->
<section class="filter-section py-3 bg-light">
    <div class="container">
        <div class="d-flex flex-wrap gap-2 justify-content-center">
            <!-- Nút "Tất cả" -->
            <a href="{{ url_for('main.projects') }}"
               class="btn btn-sm {% if not current_type %}btn-warning{% else %}btn-outline-secondary{% endif %}">
                <i class="bi bi-grid"></i> Tất cả
            </a>

            <!-- Tự động render từ config -->
            {% for project_type in project_types %}
            <a href="{{ url_for('main.projects', type=project_type.value) }}"
               class="btn btn-sm {% if current_type == project_type.value %}btn-warning{% else %}btn-outline-secondary{% endif %}"
               title="{{ project_type.description }}">
                <i class="bi {{ project_type.icon }}"></i> {{ project_type.label }}
            </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Projects -->
{% if featured_projects and not current_type %}
<section class="featured-projects py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-4">Dự án nổi bật</h2>
        <div class="row g-4">
            {% for project in featured_projects[:3] %}
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm project-card">
                    <div class="position-relative overflow-hidden">
                        <img src="{{ project.image or '/static/img/placeholder.jpg' }}" 
                             class="card-img-top" 
                             alt="{{ project.title }}"
                             style="height: 250px; object-fit: cover; transition: transform 0.3s;">
                        <span class="badge bg-warning position-absolute top-0 end-0 m-2">
                            <i class="bi bi-star-fill"></i> Nổi bật
                        </span>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{ project.title }}</h5>
                        <p class="text-muted small mb-2">
                            <i class="bi bi-geo-alt"></i> {{ project.location }}
                            {% if project.year %}
                            | <i class="bi bi-calendar"></i> {{ project.year }}
                            {% endif %}
                        </p>
                        <p class="card-text text-muted">
                            {{ project.description[:120] }}{% if project.description|length > 120 %}...{% endif %}
                        </p>
                        <a href="{{ url_for('main.project_detail', slug=project.slug) }}" 
                           class="btn btn-outline-warning">
                            Xem chi tiết <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- All Projects -->
<section class="projects-list py-5">
    <div class="container">
        {% if projects.items %}
        <div class="row g-4">
            {% for project in projects.items %}
            <div class="col-lg-4 col-md-6">
                <div class="card h-100 border-0 shadow-sm project-card">
                    <div class="position-relative overflow-hidden">
                        <img src="{{ project.image or '/static/img/placeholder.jpg' }}" 
                             class="card-img-top" 
                             alt="{{ project.title }}"
                             style="height: 220px; object-fit: cover;">
                        {% if project.is_featured %}
                        <span class="badge bg-warning position-absolute top-0 start-0 m-2">
                            <i class="bi bi-star-fill"></i>
                        </span>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        <span class="badge bg-secondary mb-2">{{ project.project_type }}</span>
                        <h5 class="card-title">{{ project.title }}</h5>
                        <p class="text-muted small mb-2">
                            {% if project.client %}
                            <i class="bi bi-building"></i> {{ project.client }}<br>
                            {% endif %}
                            <i class="bi bi-geo-alt"></i> {{ project.location }}
                            {% if project.year %}
                            | <i class="bi bi-calendar"></i> {{ project.year }}
                            {% endif %}
                        </p>
                        <p class="card-text text-muted small">
                            {{ project.description[:100] }}{% if project.description|length > 100 %}...{% endif %}
                        </p>
                    </div>
                    <div class="card-footer bg-white border-0">
                        <a href="{{ url_for('main.project_detail', slug=project.slug) }}" 
                           class="btn btn-outline-warning w-100">
                            Xem chi tiết <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Pagination -->
        {% if projects.pages > 1 %}
        <nav class="mt-5">
            <ul class="pagination justify-content-center">
                <li class="page-item {% if not projects.has_prev %}disabled{% endif %}">
                    <a class="page-link" href="{{ url_for('main.projects', page=projects.prev_num, type=current_type) }}">
                        <i class="bi bi-chevron-left"></i>
                    </a>
                </li>
                {% for page_num in projects.iter_pages(left_edge=1, right_edge=1) %}
                    {% if page_num %}
                    <li class="page-item {% if page_num == projects.page %}active{% endif %}">
                        <a class="page-link" href="{{ url_for('main.projects', page=page_num, type=current_type) }}">
                            {{ page_num }}
                        </a>
                    </li>
                    {% else %}
                    <li class="page-item disabled"><span class="page-link">...</span></li>
                    {% endif %}
                {% endfor %}
                <li class="page-item {% if not projects.has_next %}disabled{% endif %}">
                    <a class="page-link" href="{{ url_for('main.projects', page=projects.next_num, type=current_type) }}">
                        <i class="bi bi-chevron-right"></i>
                    </a>
                </li>
            </ul>
        </nav>
        {% endif %}
        {% else %}
        <div class="text-center py-5">
            <i class="bi bi-building display-1 text-muted"></i>
            <p class="text-muted mt-3">Chưa có dự án nào trong danh mục này</p>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
.project-card {
    transition: transform 0.3s, box-shadow 0.3s;
}

.project-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
}

.project-card:hover img {
    transform: scale(1.05);
}
</style>
{% endblock %}